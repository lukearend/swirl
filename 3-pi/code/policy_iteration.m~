% Performs policy iteration until optimal policy is reached.
n = 10;
num_actions = 5;
gamma = 0.9;

load('transition_probs.mat','P');
load('reward_fn.mat','R');

% Initialize random policy.
pi = randi(num_actions,n^4,1);

i = 0;
while true
    % Compute value function, then find an optimal policy.
    V_star = value_fn(pi,P,R,gamma);
    pi_star = optimal_policy(P,V_star);
    
    
    i = i + 1;

    if pi_star == pi
        break
    end
    
    pi = pi_star;
    fprintf('Finished policy iteration step %i.\n',i);
end

fprintf('Policy iteration terminated at the end of step %i.\n',i);

save('policy_iteration','pi_star');
